[{"path":"https://mattheaphy.github.io/offsetreg/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 offsetreg authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matt Heaphy. Author, maintainer, copyright holder.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Heaphy M (2024). offsetreg: Extension 'Tidymodels' Supporting Offset Terms. R package version 1.0.0, https://mattheaphy.github.io/offsetreg/, https://github.com/mattheaphy/offsetreg/.","code":"@Manual{,   title = {offsetreg: An Extension of 'Tidymodels' Supporting Offset Terms},   author = {Matt Heaphy},   year = {2024},   note = {R package version 1.0.0, https://mattheaphy.github.io/offsetreg/},   url = {https://github.com/mattheaphy/offsetreg/}, }"},{"path":"https://mattheaphy.github.io/offsetreg/index.html","id":"offsetreg","dir":"","previous_headings":"","what":"An Extension of Tidymodels Supporting Offset Terms","title":"An Extension of Tidymodels Supporting Offset Terms","text":"package extends tidymodels ecosystem enable usage predictive models offset terms. Offset terms predictors linear model known priori value. words, terms associated coefficient (βi) needs determined. generalized linear model (GLM), offset specification looks like: Ŷ = g−1(offset+β0+β1X1+β2X2+…+βpXp) Models offsets useful working count data fitting adjustment model top existing model prior expectation. former situation common insurance data often aggregated weighted exposures. latter common life insurance industry mortality tables often used starting point setting assumptions particular block business. general, offsetreg functions named existing functions tidymodels modeling package suffixed _offset. modeling engines package wrappers around existing, well-known modeling functions. engines include argument offset_col used specify column data passed engine contains offsets. Currently, following functions available: Model specifications: poisson_reg_offset() - create Poisson GLM spec Model engines glm_offset() - wrapper around stats::glm() glmnet_offset() - wrapper around glmnet::glmnet()","code":""},{"path":"https://mattheaphy.github.io/offsetreg/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An Extension of Tidymodels Supporting Offset Terms","text":"offsetreg package can installed CRAN : can install development version offsetreg GitHub :","code":"install.packages(\"offsetreg\") # install.packages(\"devtools\") devtools::install_github(\"mattheaphy/offsetreg\")"},{"path":"https://mattheaphy.github.io/offsetreg/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic usage","title":"An Extension of Tidymodels Supporting Offset Terms","text":"us_deaths data set contains United States deaths, population estimates, crude mortality rates ages 25+ CDC Multiple Causes Death Files years 2011-2020. Assume want create poisson model number deaths. First, offset term created taking natural log population, exposure basis. natural log used link function poisson regression exponential function. Create poisson regression model offset, set engine “glm_offset”. engine-specific argument offset_col must refer name column us_deaths contains offsets. Note: offset term always included model formulas. Verify coefficients match stats::glm().","code":"library(offsetreg) library(parsnip) #> Warning: package 'parsnip' was built under R version 4.2.3 us_deaths #> # A tibble: 140 × 6 #>    gender age_group  year deaths population       qx #>    <fct>  <fct>     <int>  <dbl>      <dbl>    <dbl> #>  1 Female 25-34      2011  13663   20746335 0.000659 #>  2 Female 25-34      2012  13808   20970529 0.000658 #>  3 Female 25-34      2013  14001   21203096 0.000660 #>  4 Female 25-34      2014  14480   21546290 0.000672 #>  5 Female 25-34      2015  15736   21838064 0.000721 #>  6 Female 25-34      2016  17359   22077505 0.000786 #>  7 Female 25-34      2017  18066   22351311 0.000808 #>  8 Female 25-34      2018  17980   22487065 0.000800 #>  9 Female 25-34      2019  17827   22581141 0.000789 #> 10 Female 25-34      2020  21654   22625267 0.000957 #> # ℹ 130 more rows us_deaths$offset <- log(us_deaths$population) glm_off <- poisson_reg_offset() |>   # set the modeling engine and specify the offset column   set_engine(\"glm_offset\", offset_col = \"offset\") |>   # always include the offset term in the model formula   fit(deaths ~ gender + age_group + year + offset, data = us_deaths)  glm_off #> parsnip model object #>  #>  #> Call:  stats::glm(formula = formula, family = family, data = data, offset = offset) #>  #> Coefficients: #>    (Intercept)      genderMale  age_group35-44  age_group45-54  age_group55-64   #>     -18.337940        0.327632        0.442935        1.212463        1.990698   #> age_group65-74  age_group75-84    age_group85+            year   #>       2.713410        3.645763        4.770408        0.005683   #>  #> Degrees of Freedom: 139 Total (i.e. Null);  131 Residual #> Null Deviance:       51700000  #> Residual Deviance: 237800    AIC: 239800 glm_base <- glm(deaths ~ gender + age_group + year, offset = offset,                 data = us_deaths, family = 'poisson')  identical(extract_fit_engine(glm_off) |> coef(), coef(glm_base)) #> [1] TRUE"},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Generalized Linear Models with an Offset — glm_offset","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"function wrapper around stats::glm() uses column data offset.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"","code":"glm_offset(formula, family = \"gaussian\", data, offset_col = \"offset\", weights)"},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"formula model formula family function character string describing link function error distribution. data Optional. data frame containing variables used model. offset_col Character string. name column data containing offsets. weights Weights use fitting process.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"glm object. See stats::glm() full details.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"Outside tidymodels ecosystem, glm_offset() advantages stats::glm() since function allows offsets specified formula interface offset argument. Within tidymodels, glm_offset() provides advantage ensure offsets included data whenever resamples created. formula, family, data, weights arguments meanings stats::glm(). See function's documentation full details.","code":""},{"path":[]},{"path":"https://mattheaphy.github.io/offsetreg/reference/glm_offset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Generalized Linear Models with an Offset — glm_offset","text":"","code":"us_deaths$off <- log(us_deaths$population) glm_offset(deaths ~ age_group + gender, family = \"poisson\",            us_deaths, offset_col = \"off\") #>  #> Call:  stats::glm(formula = formula, family = family, data = data, offset = offset) #>  #> Coefficients: #>    (Intercept)  age_group35-44  age_group45-54  age_group55-64  age_group65-74   #>        -6.8842          0.4426          1.2114          1.9908          2.7147   #> age_group75-84    age_group85+      genderMale   #>         3.6465          4.7707          0.3280   #>  #> Degrees of Freedom: 139 Total (i.e. Null);  132 Residual #> Null Deviance:\t    51700000  #> Residual Deviance: 245000 \tAIC: 246900"},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"function wrapper around glmnet::glmnet() uses column x offset.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"","code":"glmnet_offset(   x,   y,   family,   offset_col = \"offset\",   weights = NULL,   lambda = NULL,   alpha = 1 )"},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"x Input matrix y Response variable family function character string describing link function error distribution. offset_col Character string. name column data containing offsets. weights Weights use fitting process. lambda numeric vector regularization penalty values alpha number zero one denoting proportion L1 (lasso) versus L2 (ridge) regularization. alpha = 1: Pure lasso model alpha = 0: Pure ridge model","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"glmnet object. See glmnet::glmnet() full details.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"Outside tidymodels ecosystem, glmnet_offset() advantages glmnet::glmnet() since function allows offsets specified offset argument. Within tidymodels, glmnet_offset() provides advantage ensure offsets included data whenever resamples created. x, y, family, lambda, alpha weights arguments meanings glmnet::glmnet(). See function's documentation full details.","code":""},{"path":[]},{"path":"https://mattheaphy.github.io/offsetreg/reference/glmnet_offset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Penalized Generalized Linear Models with an Offset — glmnet_offset","text":"","code":"us_deaths$off <- log(us_deaths$population) x <- model.matrix(~ age_group + gender + off, us_deaths)[, -1] glmnet_offset(x, us_deaths$deaths, family = \"poisson\", offset_col = \"off\") #>  #> Call:  glmnet::glmnet(x = x, y = y, family = family, weights = weights,      offset = offsets, alpha = alpha, lambda = lambda)  #>  #>    Df  %Dev Lambda #> 1   0  0.00 159700 #> 2   1 19.30 145600 #> 3   1 29.40 132600 #> 4   1 35.78 120800 #> 5   1 40.18 110100 #> 6   2 44.76 100300 #> 7   2 52.46  91410 #> 8   2 58.11  83290 #> 9   2 62.41  75890 #> 10  2 65.75  69150 #> 11  2 68.40  63010 #> 12  3 70.59  57410 #> 13  4 73.19  52310 #> 14  4 76.34  47660 #> 15  4 78.94  43430 #> 16  4 81.10  39570 #> 17  4 82.91  36050 #> 18  4 84.42  32850 #> 19  4 85.70  29930 #> 20  4 86.77  27270 #> 21  5 87.80  24850 #> 22  5 88.77  22640 #> 23  6 89.91  20630 #> 24  6 91.14  18800 #> 25  6 92.19  17130 #> 26  6 93.08  15610 #> 27  6 93.85  14220 #> 28  6 94.50  12960 #> 29  6 95.05  11810 #> 30  6 95.52  10760 #> 31  6 95.92   9802 #> 32  6 96.27   8931 #> 33  6 96.56   8138 #> 34  6 96.80   7415 #> 35  6 97.01   6756 #> 36  6 97.19   6156 #> 37  6 97.34   5609 #> 38  7 97.48   5111 #> 39  7 97.75   4657 #> 40  7 98.00   4243 #> 41  7 98.21   3866 #> 42  7 98.39   3523 #> 43  7 98.55   3210 #> 44  7 98.69   2925 #> 45  7 98.81   2665 #> 46  7 98.91   2428 #> 47  7 99.00   2212 #> 48  6 99.08   2016 #> 49  6 99.13   1837 #> 50  6 99.17   1674 #> 51  6 99.21   1525 #> 52  6 99.24   1389 #> 53  6 99.26   1266 #> 54  6 99.29   1153 #> 55  6 99.30   1051 #> 56  6 99.32    958 #> 57  6 99.33    873 #> 58  7 99.36    795 #> 59  7 99.38    724 #> 60  7 99.41    660 #> 61  7 99.42    601 #> 62  7 99.44    548 #> 63  7 99.45    499 #> 64  7 99.46    455 #> 65  7 99.47    414 #> 66  7 99.48    378 #> 67  7 99.49    344 #> 68  7 99.49    314 #> 69  7 99.50    286 #> 70  7 99.50    260 #> 71  7 99.51    237 #> 72  7 99.51    216 #> 73  7 99.51    197 #> 74  7 99.51    179 #> 75  7 99.52    164"},{"path":"https://mattheaphy.github.io/offsetreg/reference/offsetreg-package.html","id":null,"dir":"Reference","previous_headings":"","what":"offsetreg: An Extension of 'Tidymodels' Supporting Offset Terms — offsetreg-package","title":"offsetreg: An Extension of 'Tidymodels' Supporting Offset Terms — offsetreg-package","text":"package extends 'tidymodels' ecosystem https://www.tidymodels.org/ enable usage predictive models offset terms. Models offsets useful working count data fitting adjustment model top existing model prior expectation. former situation common insurance data often weighted exposures. latter common life insurance industry mortality tables often used starting point setting assumptions.","code":""},{"path":[]},{"path":"https://mattheaphy.github.io/offsetreg/reference/offsetreg-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"offsetreg: An Extension of 'Tidymodels' Supporting Offset Terms — offsetreg-package","text":"Maintainer: Matt Heaphy mattrmattrs@gmail.com [copyright holder]","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":null,"dir":"Reference","previous_headings":"","what":"Poisson regression models with offsets — poisson_reg_offset","title":"Poisson regression models with offsets — poisson_reg_offset","text":"poisson_reg_offset() defines generalized linear model count data offset follow Poisson distribution.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Poisson regression models with offsets — poisson_reg_offset","text":"","code":"poisson_reg_offset(   mode = \"regression\",   penalty = NULL,   mixture = NULL,   engine = \"glm_offset\" )"},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Poisson regression models with offsets — poisson_reg_offset","text":"mode single character string type model. possible value model \"regression\". penalty non-negative number representing total amount regularization (glmnet ). mixture number zero one (inclusive) giving proportion L1 regularization (.e. lasso) model. mixture = 1 specifies pure lasso model, mixture = 0  specifies ridge regression model, 0 < mixture < 1 specifies elastic net model, interpolating lasso ridge. Available glmnet spark . engine single character string specifying computational engine use fitting.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Poisson regression models with offsets — poisson_reg_offset","text":"model specification object classes poisson_reg_offset model_spec.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Poisson regression models with offsets — poisson_reg_offset","text":"function similar parsnip::poisson_reg() except specification offset column required.","code":""},{"path":[]},{"path":"https://mattheaphy.github.io/offsetreg/reference/poisson_reg_offset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Poisson regression models with offsets — poisson_reg_offset","text":"","code":"parsnip::show_model_info(\"poisson_reg_offset\") #> Information for `poisson_reg_offset` #>  modes: unknown, regression  #>  #>  engines:  #>    regression: glm_offset, glmnet_offset¹ #>  #> ¹The model can use case weights. #>  #>  arguments:  #>    glmnet_offset:  #>       penalty --> lambda #>       mixture --> alpha #>  #>  fit modules: #>           engine       mode #>       glm_offset regression #>    glmnet_offset regression #>  #>  prediction modules: #>          mode        engine      methods #>    regression    glm_offset numeric, raw #>    regression glmnet_offset numeric, raw #>   poisson_reg_offset() #> Poisson Regression with Offsets Model Specification (regression) #>  #> Computational engine: glm_offset  #>"},{"path":"https://mattheaphy.github.io/offsetreg/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics min_grid parsnip translate","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/us_deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"United States Deaths 2011-2020 — us_deaths","title":"United States Deaths 2011-2020 — us_deaths","text":"United States deaths, population estimates, crude mortality rates ages 25+ CDC Multiple Causes Death Files.","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/us_deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"United States Deaths 2011-2020 — us_deaths","text":"","code":"us_deaths"},{"path":"https://mattheaphy.github.io/offsetreg/reference/us_deaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"United States Deaths 2011-2020 — us_deaths","text":"data frame 140 rows 6 columns. gender Gender age_group Attained age groups year Calendar year deaths Number deaths population Population estimate qx Crude mortality rate equal deaths / population","code":""},{"path":"https://mattheaphy.github.io/offsetreg/reference/us_deaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"United States Deaths 2011-2020 — us_deaths","text":"Centers Disease Control Prevention, National Center Health Statistics. National Vital Statistics System, Mortality 1999-2020 CDC WONDER Online Database, released 2021. Data Multiple Cause Death Files, 1999-2020, compiled data provided 57 vital statistics jurisdictions Vital Statistics Cooperative Program. Accessed http://wonder.cdc.gov/mcd-icd10.html Jan 15, 2024.\"","code":""},{"path":"https://mattheaphy.github.io/offsetreg/news/index.html","id":"offsetreg-100","dir":"Changelog","previous_headings":"","what":"offsetreg 1.0.0","title":"offsetreg 1.0.0","text":"CRAN release: 2024-01-23 Initial CRAN release offsetreg includes one model specification, poisson_reg_offset() support two engines: glm_offset() glmnet_offset(), wrappers around stats::glm() glmnet::glmnet(), respectively.","code":""}]
